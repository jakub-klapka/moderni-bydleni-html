(function(c){var f={init:function(){this.gallery=c(".article_gallery_content");this.image_area=this.gallery.find(".image_area");this.left_button=this.image_area.find(".left");this.right_button=this.image_area.find(".right");this.current_image_index=0;this.images_and_placeholders=!1;this.setImagesAndPlaceholders();this.number_of_images=this.images_and_placeholders.length-1;this.thumbs_window=this.gallery.find(".thumbs_window");this.thumb_wrap=this.thumbs_window.find(".thumbs_wrap");this.thumb_height=
this.thumb_width=100;this.thumb_left=this.gallery.find(".controls .left");this.thumb_right=this.gallery.find(".controls .right");this.lazyLoadThumbnails();this.thumbnails=this.thumb_wrap.find("a");this.thumb_page=1;this.thumbs_on_page=7;this.thumb_page_width=812;this.num_of_pages=Math.ceil((this.number_of_images+1)/this.thumbs_on_page);this.bindEvents()},setImagesAndPlaceholders:function(){this.images_and_placeholders=this.image_area.find("img, .image_placeholder")},bindEvents:function(){this.left_button.on("click",
c.proxy(this.moveOneToLeft,this));this.right_button.on("click",c.proxy(this.moveOneToRight,this));var a=this;this.thumbnails.on("click",function(b){b.preventDefault();b=a.thumbnails.index(this);a.moveToIndex(b)});this.thumb_left.on("click",c.proxy(this.thumbPageLeft,this));this.thumb_right.on("click",c.proxy(this.thumbPageRight,this));c(document).on("keyup",function(b){Modernizr.mq("only all and ( min-width: 960px )")&&(b.preventDefault(),37===b.which&&a.moveOneToLeft(),39===b.which&&a.moveOneToRight())})},
lazyLoadThumbnails:function(){var a=this;this.thumb_wrap.find(".thumb_placeholder").each(function(){var b=c(this),d=c("<img />").attr("src",b.data("src")).attr("alt",b.data("alt")).attr("width",a.thumb_width).attr("height",a.thumb_height),e=c("<a/>").attr("href",b.data("full_image_href"));e.append(d);b.after(e);b.remove()})},moveToIndex:function(a){this.checkPlaceholder(a);this.images_and_placeholders.removeClass("active");this.images_and_placeholders.eq(a).addClass("active");this.changeActiveThumb(a);
0===a?this.left_button.addClass("inactive"):this.left_button.removeClass("inactive");a===this.number_of_images?this.right_button.addClass("inactive"):this.right_button.removeClass("inactive");this.current_image_index=a},moveOneToRight:function(){this.current_image_index<this.number_of_images&&this.moveToIndex(this.current_image_index+1)},moveOneToLeft:function(){0<this.current_image_index&&this.moveToIndex(this.current_image_index-1)},checkPlaceholder:function(a){var b=this.images_and_placeholders.eq(a),
d=1<a?this.images_and_placeholders.eq(a-1):c();a=this.images_and_placeholders.eq(a+1);b.is(".image_placeholder")&&this.setPlaceholder(b);d.is(".image_placeholder")&&this.setPlaceholder(d);a.is(".image_placeholder")&&this.setPlaceholder(a);this.setImagesAndPlaceholders()},setPlaceholder:function(a){var b=c("<img/>").attr("src",a.data("src")).attr("width",a.data("width")).attr("height",a.data("height")).attr("alt",a.data("alt"));a.after(b);a.remove()},changeActiveThumb:function(a){var b=Math.ceil((a+
1)/this.thumbs_on_page);this.thumb_page!==b&&this.setThumbPage(b);this.thumbnails.removeClass("active");this.thumbnails.eq(a).addClass("active")},setThumbPage:function(a){this.thumb_wrap.css("margin-left",-((a-1)*this.thumb_page_width));1===a?this.thumb_left.addClass("inactive"):this.thumb_left.removeClass("inactive");a===this.num_of_pages?this.thumb_right.addClass("inactive"):this.thumb_right.removeClass("inactive");this.thumb_page=a},thumbPageLeft:function(){1!==this.thumb_page&&this.setThumbPage(this.thumb_page-
1)},thumbPageRight:function(){this.thumb_page!==this.num_of_pages&&this.setThumbPage(this.thumb_page+1)}};c(document).ready(function(){f.init()})})(jQuery);
